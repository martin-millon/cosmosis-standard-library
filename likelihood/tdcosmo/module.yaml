name: tdcosmo
version: '2023'
purpose: Likelihood of the TDCOSMO analyses
url: 10.1051/0004-6361/202555801
interface: tdcosmo_likelihood.py
attribution:
  - TDCOSMO 2025 et al. (https://arxiv.org/abs/2506.03023)
  - TDCOSMO IV (Birrer et al.) for the measurement
  - Martin Millon, Judit Prat and Simon Birrer for the cosmoSIS implementation
rules: None.
cite:
  - TDCOSMO Collaboration et al. 2025, A&A, 704, A63
  - Birrer et al., 2020, A&A, 643, A165
  - Suyu et al., 2010, ApJ, 711, 201
  - Suyu et al., 2014, ApJ, 788, L35
  - Wong et al., 2017, MNRAS, 465, 4895
  - Birrer et al., 2019, MNRAS, 484, 4726
  - Chen et al., 2019, MNRAS, 490, 1743
  - Jee et al., 2019, Science, 365, 1134
  - Rusu et al., 2020, MNRAS, 498, 1440
  - Wong et al., 2020, MNRAS, 498, 1420
  - Sahjib et al., 2020, MNRAS, 494, 6072
assumptions:
  -   Strong lensing modelling details.
  -   Time delay distance structure
  -   Hierarchical inference of the mass model and stellar anisotropy parameters
explanation: | 
    This module contain the likelihood of a 8 time-delay lenses, presented in TDCOSMO 2025 (TDCOSMO collaboration et al., 2025).
    This module allows us to reproduce the hierarchical inference of the cosmological parameters and of the lens population parameters,
    which are grouped under the block `nuisance_strong_lensing` (see details below). 
    For the TDCOSMO 2025 analysis, additional data sets such as 'SLACS_KCWI' (11 lenses) and 'SL2S' (4 lenses) can be added to the 'tdcosmo2025' data set to help constrain these parameters.
    Adding these 2 data sets requires to make the additional assumption that the lensing galaxy of the 8 TDCOSMO lenses and of the SLACS and SL2S lenses 
    come from the same population of galaxies.
  
    Alternatively one can recover the previous analysis from TDCOSMO IV (Birrer et al., 2020) by choosing the 'tdcosmo_iv' analysis option.
    For the TDCOSMO IV analysis, additional data sets such as 'SLACS_SDSS' and 'SLACS_IFU' can be added to the 'tdcosmo7' data set to help constrain these parameters.
    However, it is NOT recommended to use the 'SLACS_SDSS' data set anymore (see TDCOSMO 2025 for details).

params:
  analysis:
    meaning: Type of analysis to perform. 'tdcosmo_iv' or 'tdcomso2025' for the TDCOSMO IV and TDCOSMO 2025 analysis respectively.
    type: str
    default: 'tdcosmo2025'
  data_sets:
    meaning: Data sets to use. For the 'tdcosmo_iv' analysis, choose any combination of 'tdcosmo7', 'SLACS_SDSS' and 'SLACS_IFU'. You can use 'tdcosmo7+SLACS_SDSS' or 'tdcosmo7+SLACS_SDSS+SLACS_IFU' for example. For the 'tdcosmo2025' analysis, available data sets are 'tdcosmo2025', 'SLACS_KCWI' and 'SL2S'. You can use 'tdcosmo2025+SLACS_KCWI' or 'tdcosmo2025+SLACS_KCWI+SL2S' for example.
    type: str
    default: 'tdcosmo2025'

  num_distribution_draws:
    meaning: Number of random realisation for kinematic computations.
    type: int
    default: 200

  distances_computation_module:
    meaning: Module used distance-redshift relation. 'astropy' uses standard astropy cosmology w0waCDM. 
              'CosmoInterp' to use the CosmoInterp module of lenstronomy to interpolate. 'camb' will use the distances 
              provided by camb to compute Ds, Dd, and Dds.
    type: str
    default: 'astropy'

inputs:
  cosmological_parameters:
    omega_l:
      meaning: Dark energy density fraction today
      type: real
      default:
    h0:
      meaning: Hubble parameter H0 (km/s/Mpc)
      type: real
      default:
    omega_m:
      meaning: Dark matter density fraction today
      type: real
      default:

  nuisance_strong_lensing:
    lambda_mst:
      meaning: Internal Mass sheet degeneracy parameter
      type: real
      default: 1.0

    lambda_mst_sigma:
      meaning: 1-sigma Gaussian scatter in lambda_mst
      type: real
      default: 0.04

    alpha_lambda:
      meaning: Slope of lambda_mst with r_eff/theta_E
      type: real
      default: 0.0

    a_ani:
      meaning: mean a_ani anisotropy parameter in the Osipkov-Merritt model
      type: real
      default: 1.5

    a_ani_sigma:
      meaning: 1-sigma Gaussian scatter in a_ani
      type: real
      default: 0.3

    gamma_pl_RXJ1131:
      meaning: Power-law slope of RXJ1131 lens mass profile. Used only in 'tdcosmo2025' analysis. The slope will be constrained using JWST NIRSpec IFU kinematics data.
      type: real
      default: 1.95

    gamma_pl_SLACS_KCWI0:
      meaning: Power-law slope of SDSSJ0029-0055 lens mass profile. Used only in 'tdcosmo2025' analysis + 'SLACS_KCWI' data_sets. The slope will be constrained using KCWI IFU kinematics data.
      type: real
      default: 2.0

    gamma_pl_SLACS_KCWI1:
      meaning: Power-law slope of SDSSJ0037-0942 lens mass profile. Used only in 'tdcosmo2025' analysis + 'SLACS_KCWI' data_sets. The slope will be constrained using KCWI IFU kinematics data.
      type: real
      default: 2.0

    gamma_pl_SLACS_KCWI2:
      meaning: Power-law slope of SDSSJ1112+0826 lens mass profile. Used only in 'tdcosmo2025' analysis + 'SLACS_KCWI' data_sets. The slope will be constrained using KCWI IFU kinematics data.
      type: real
      default: 2.0

    gamma_pl_SLACS_KCWI3:
      meaning: Power-law slope of SDSSJ1204+0358 lens mass profile. Used only in 'tdcosmo2025' analysis + 'SLACS_KCWI' data_sets. The slope will be constrained using KCWI IFU kinematics data.
      type: real
      default: 2.0

    gamma_pl_SLACS_KCWI4:
      meaning: Power-law slope of SDSSJ1250+0523 lens mass profile. Used only in 'tdcosmo2025' analysis + 'SLACS_KCWI' data_sets. The slope will be constrained using KCWI IFU kinematics data.
      type: real
      default: 2.0

    gamma_pl_SLACS_KCWI5:
      meaning: Power-law slope of SDSSJ1306+0600 lens mass profile. Used only in 'tdcosmo2025' analysis + 'SLACS_KCWI' data_sets. The slope will be constrained using KCWI IFU kinematics data.
      type: real
      default: 2.0

    gamma_pl_SLACS_KCWI6:
      meaning: Power-law slope of SDSSJ1402+6321 lens mass profile. Used only in 'tdcosmo2025' analysis + 'SLACS_KCWI' data_sets. The slope will be constrained using KCWI IFU kinematics data.
      type: real
      default: 2.0

    gamma_pl_SLACS_KCWI7:
      meaning: Power-law slope of SDSSJ1531-0105 lens mass profile. Used only in 'tdcosmo2025' analysis + 'SLACS_KCWI' data_sets. The slope will be constrained using KCWI IFU kinematics data.
      type: real
      default: 2.0

    gamma_pl_SLACS_KCWI8:
      meaning: Power-law slope of SDSSJ1621+3931 lens mass profile. Used only in 'tdcosmo2025' analysis + 'SLACS_KCWI' data_sets. The slope will be constrained using KCWI IFU kinematics data.
      type: real
      default: 2.0

    gamma_pl_SLACS_KCWI9:
      meaning: Power-law slope of SDSSJ1627-0053 lens mass profile. Used only in 'tdcosmo2025' analysis + 'SLACS_KCWI' data_sets. The slope will be constrained using KCWI IFU kinematics data.
      type: real
      default: 2.0

    gamma_pl_SLACS_KCWI10:
      meaning: Power-law slope of SDSSJ1630+4520 lens mass profile. Used only in 'tdcosmo2025' analysis + 'SLACS_KCWI' data_sets. The slope will be constrained using KCWI IFU kinematics data.
      type: real
      default: 2.0

outputs:
  likelihoods:
    TDCOSMO_like:
      meaning: Total likelihood of the TDCOSMO sample
      type: real

